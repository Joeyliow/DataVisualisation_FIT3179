{
    "$schema": "https://vega.github.io/schema/vega/v5.json",
    "title": {
        "text": ["Evaluation of Agricultural Factors",""],
        "fontSize": 16,
        "color":"#636363",
        "offset":20      
      },
    "width": 600,
    "height": 600,
    "padding": {"top": 10, "left": 10, "right": 10, "bottom": 60},
    "autosize": {"type": "fit", "resize": true, "contains": "padding"},
    "signals": [
      {"name": "radius", "update": "min(width, height) / 1.5"},
      {
        "name": "Year_selection",
        "value": 2023,
        "bind": {
          "input": "select",
          "options": [2020, 2021, 2022, 2023],
          "name": "Year: "
        }
      },
      {
        "name": "Country_selection",
        "value": null,
        "bind": {
          "input": "select",
          "options": [
            null,
            "Argentina",
            "Australia",
            "Brazil",
            "China",
            "Canada",
            "France",
            "India",
            "Nigeria",
            "Russia",
            "USA"
          ],
          "labels":[
            "Show All",
            "Argentina",
            "Australia",
            "Brazil",
            "China",
            "Canada",
            "France",
            "India",
            "Nigeria",
            "Russia",
            "USA"
            ],
          "name": "Country: "
        }
      }
    ],
  
    "data": [
      {
        "name": "table",
        "url": "agricultural_resources.csv",
        "format": {"type": "csv"},
        "transform": [
          {"type": "filter", "expr": "datum.Year == Year_selection"},
          {"type": "filter", "expr": "!Country_selection || datum.Country == Country_selection"},
          {
            "type": "fold",
            "fields": [
              "Soil_Health_Index",
              "Fertilizer_Use_KG_per_HA",
              "Pesticide_Use_KG_per_HA",
              "Irrigation_Access_%"
            ],
            "as": ["key", "value"]
          }
        ]
      },
      {
        "name": "keys",
        "source": "table",
        "transform": [
          {"type": "aggregate", "groupby": ["key"]}
        ]
      }
    ],
  
    "scales": [
      {
        "name": "angular",
        "type": "point",
        "range": {"signal": "[-PI, PI]"},
        "padding": 0.5,
        "domain": {"data": "table", "field": "key"}
      },
      {
        "name": "radial",
        "type": "linear",
        "range": {"signal": "[0, radius]"},
        "zero": true,
        "nice": false,
        "domain": {"data": "table", "field": "value"}
      },
      {
        "name": "color",
        "type": "ordinal",
        "domain": [
          "Argentina",
          "Australia",
          "Brazil",
          "China",
          "Canada",
          "France",
          "India",
          "Nigeria",
          "Russia",
          "USA"
        ],
        "range": [
          "#66c2a5",  
          "#fc8d62",  
          "#8da0cb", 
          "#e78ac3",  
          "#a6d854", 
          "#ffd92f",  
          "#e5c494",  
          "#b3b3b3",  
          "#fdb462", 
          "#bc80bd"   
        ]
      }
    ],
  
    "legends": [
      {
        "fill": "color",
        "title": "Country",
        "orient": "top-right",
        "anchor":"start",
        "direction": "vertical",
        "allign":"left",
        "symbolType": "circle",
        "symbolSize": 100,
        "labelFontSize": 10,
        "labelColor":"#636363",
        "titleFontSize": 12,
        "titleColor": "#636363",
        "titleFontWeight":"normal",
        "offset":10
      
      }
    ],
  
    "marks": [
      {
        "type": "group",
        "name": "categories",
        "zindex": 1,
        "from": {
          "facet": {"data": "table", "name": "facet", "groupby": ["Country"]}
        },
        "marks": [
          {
            "type": "line",
            "name": "category-line",
            "from": {"data": "facet"},
            "encode": {
              "enter": {
                "interpolate": {"value": "linear-closed"},
                "x": {"signal": "scale('radial', datum.value) * cos(scale('angular', datum.key))"},
                "y": {"signal": "scale('radial', datum.value) * sin(scale('angular', datum.key))"},
                "stroke": {"scale": "color", "field": "Country"},
                "strokeWidth": {"value": 2},
                "fill": {"scale": "color", "field": "Country"},
                "fillOpacity": {"value": 0.3}
              }
            }
          },
          {
            "type": "symbol",
            "name": "points",
            "from": {"data": "facet"},
            "encode": {
              "enter": {
                "size": {"value": 100},
                "x": {"signal": "scale('radial', datum.value) * cos(scale('angular', datum.key))"},
                "y": {"signal": "scale('radial', datum.value) * sin(scale('angular', datum.key))"},
                "fill": {"scale": "color", "field": "Country"},
                "fillOpacity": {"value": 0.7}
              },
              "update": {
                "tooltip": {
                  "signal": "{'Country': datum.Country, 'Attribute': datum.key === 'Soil_Health_Index' ? 'Soil Health Index' : datum.key === 'Fertilizer_Use_KG_per_HA' ? 'Usage of Fertilizer (Kilogram per Hectare)' : datum.key === 'Pesticide_Use_KG_per_HA' ? 'Usage of Pesticide (Kilogram per Hectare)' : datum.key === 'Irrigation_Access_%' ? 'Percentage of Irrigation Access' : datum.key, 'Value': format(datum.value, '.3f')}"
                }
              }
            }
          }
        ]
      },
      {
        "type": "rule",
        "name": "radial-grid",
        "from": {"data": "keys"},
        "zindex": 0,
        "encode": {
          "enter": {
            "x": {"value": 0},
            "y": {"value": 0},
            "x2": {"signal": "radius * cos(scale('angular', datum.key))"},
            "y2": {"signal": "radius * sin(scale('angular', datum.key))"},
            "stroke": {"value": "lightgray"},
            "strokeWidth": {"value": 1}
          }
        }
      },
      {
        "type": "text",
        "name": "key-label",
        "from": {"data": "keys"},
        "zindex": 1,
        "encode": {
          "enter": {
            "x": {"signal": "(radius + 25) * cos(scale('angular', datum.key))"},
            "y": {"signal": "(radius + 25) * sin(scale('angular', datum.key))"},
            "text": {"signal": "datum.key === 'Soil_Health_Index' ? 'Soil Health Index' : datum.key === 'Fertilizer_Use_KG_per_HA' ? 'Fertilizer Use (Kilogram per Hectare)' : datum.key === 'Pesticide_Use_KG_per_HA' ? 'Pesticide Use (Kilogram per Hectare)' : 'Irrigation Access (%)'"},
            "align": {"value": "center"},
            "baseline": {"value": "middle"},
            "fill": {"value": "grey"},
            "fontSize": {"value": 12},
            "fontWeight":{"value":"bold"}
          }
        }
      }
    ]
  }